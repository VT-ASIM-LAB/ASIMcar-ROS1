<!-- -*- mode: XML -*- -->
<launch>
  <!-- Parameter -->
  <arg name="vesc_port" default="/dev/VESC" />
  
  <!-- Config -->
  <arg name="vesc_config" default="$(find asimcar)/config/vesc.yaml" />
  <rosparam file="$(arg vesc_config)" command="load" />

  <!-- Ackermann to VESC cmd -->
  <group ns="vesc">
    <node pkg="vesc_ackermann" type="ackermann_to_vesc_node" name="ackermann_to_vesc">
      <!-- Remap to make vesc have trapezoidal control on the throttle to avoid skipping -->
      <remap from="commands/motor/speed" to="commands/motor/unsmoothed_speed" />
      <!-- Remap to make vesc have trapezoidal control on the servo to avoid incorrect odometry and damange -->
      <remap from="commands/servo/position" to="commands/servo/unsmoothed_position" />
    </node>
    <!-- VESC -->
    <node pkg="vesc_driver" type="vesc_driver_node" name="vesc_driver">
      <param name="port" value="$(arg vesc_port)" />
    </node>
    <node pkg="vesc_ackermann" type="vesc_to_odom_node" name="vesc_to_odom" />
    <node pkg="asimcar" type="command_interpreter.py" name="command_interpreter_node" />
  </group>
</launch>
